{
    "components": {
        "schemas": {
            "HTTPValidationError": {
                "properties": {
                    "detail": {
                        "items": {
                            "$ref": "#/components/schemas/ValidationError"
                        },
                        "title": "Detail",
                        "type": "array"
                    }
                },
                "title": "HTTPValidationError",
                "type": "object"
            },
            "ValidationError": {
                "properties": {
                    "loc": {
                        "items": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "integer"
                                }
                            ]
                        },
                        "title": "Location",
                        "type": "array"
                    },
                    "msg": {
                        "title": "Message",
                        "type": "string"
                    },
                    "type": {
                        "title": "Error Type",
                        "type": "string"
                    }
                },
                "required": [
                    "loc",
                    "msg",
                    "type"
                ],
                "title": "ValidationError",
                "type": "object"
            }
        }
    },
    "info": {
        "description": "\n**Docker Dorker API**\n* WIP\n* TBD    \n    ",
        "title": "Docker Dorker API",
        "version": "1.0.0"
    },
    "openapi": "3.1.0",
    "paths": {
        "/carve": {
            "get": {
                "description": "## Carve\n\nCarve a single file from a Docker image and return it as a browser download.\n\n- Uses HTTP Range requests to efficiently extract just the target file\nwithout downloading the entire layer.\n\n**IMPORTANT:** The `layer` parameter is REQUIRED. Use `/peek/status` to discover\nwhich layer(s) contain your target file before carving.\n\n### Parameters\n    \n- `image` : `nginx/nginx:alpine`\n    - `namespace/repo:tag`\n- `path` : `/etc/passwd`\n    - Absolute path of the remote file\n- `layer` : `0` (REQUIRED)\n    - Layer index containing the file to carve\n    - Use `/peek/status?image=...` to discover layer indices\n    - Example: `/carve?image=nginx/nginx:alpine&path=/etc/passwd&layer=0`\n- `as_text` : `true`\n    - Allows viewing the file in browser instead of saving to disk\n    - Example: `/carve?image=nginx/nginx:alpine&path=/etc/passwd&layer=0&as_text=true`",
                "operationId": "carve_carve_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "image",
                        "required": true,
                        "schema": {
                            "title": "Image",
                            "type": "string"
                        }
                    },
                    {
                        "description": "File path in container, e.g., /etc/passwd",
                        "in": "query",
                        "name": "path",
                        "required": true,
                        "schema": {
                            "description": "File path in container, e.g., /etc/passwd",
                            "title": "Path",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Layer index to extract from (REQUIRED). Use /peek/status to discover layer indices.",
                        "in": "query",
                        "name": "layer",
                        "required": true,
                        "schema": {
                            "description": "Layer index to extract from (REQUIRED). Use /peek/status to discover layer indices.",
                            "title": "Layer",
                            "type": "integer"
                        }
                    },
                    {
                        "description": "Render as plain text in browser instead of downloading",
                        "in": "query",
                        "name": "as_text",
                        "required": false,
                        "schema": {
                            "default": false,
                            "description": "Render as plain text in browser instead of downloading",
                            "title": "As Text",
                            "type": "boolean"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Carve"
            }
        },
        "/fslog": {
            "get": {
                "description": "## /fslog\n\nBrowse filesystem logs for a Docker image layer.",
                "operationId": "fslog_fslog_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "image",
                        "required": true,
                        "schema": {
                            "title": "Image",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "path",
                        "required": true,
                        "schema": {
                            "title": "Path",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "layer",
                        "required": false,
                        "schema": {
                            "title": "Layer",
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Fslog"
            }
        },
        "/fslog-search": {
            "get": {
                "description": "## /fslog-search\n\nSearch filesystem logs for files matching a pattern.",
                "operationId": "fslog_search_fslog_search_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "q",
                        "required": true,
                        "schema": {
                            "title": "Q",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "image",
                        "required": false,
                        "schema": {
                            "title": "Image",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "layer",
                        "required": false,
                        "schema": {
                            "title": "Layer",
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Fslog Search"
            }
        },
        "/history": {
            "get": {
                "description": "## /history\n\nList cached scan results from the database.\n\n- Returns formatted text table with previously peeked layers.\n\n- Example: `/history?q=nginx&page=1&page_size=30&sortby=scraped_at&order=desc`",
                "operationId": "history_history_get",
                "parameters": [
                    {
                        "description": "Filter by owner, repo, or tag",
                        "in": "query",
                        "name": "q",
                        "required": false,
                        "schema": {
                            "description": "Filter by owner, repo, or tag",
                            "title": "Q",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Page number",
                        "in": "query",
                        "name": "page",
                        "required": false,
                        "schema": {
                            "default": 1,
                            "description": "Page number",
                            "minimum": 1,
                            "title": "Page",
                            "type": "integer"
                        }
                    },
                    {
                        "description": "Results per page",
                        "in": "query",
                        "name": "page_size",
                        "required": false,
                        "schema": {
                            "default": 30,
                            "description": "Results per page",
                            "maximum": 100,
                            "minimum": 1,
                            "title": "Page Size",
                            "type": "integer"
                        }
                    },
                    {
                        "description": "Column to sort by",
                        "in": "query",
                        "name": "sortby",
                        "required": false,
                        "schema": {
                            "default": "scraped_at",
                            "description": "Column to sort by",
                            "title": "Sortby",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Sort order: asc or desc",
                        "in": "query",
                        "name": "order",
                        "required": false,
                        "schema": {
                            "default": "desc",
                            "description": "Sort order: asc or desc",
                            "title": "Order",
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "History"
            }
        },
        "/layer/download": {
            "get": {
                "description": "## Stream a layer\n\nStream a layer blob directly to the browser as a download.\n\n- Acts as an authenticated proxy - fetches the layer from the registry\nand streams it directly to the browser without intermediate storage.\n\nExample: `/layer/download?image=nginx/nginx:alpine&digest=sha256:abc123...`\n\n### Paramteters\n    \n- `image` : `nginx/nginx:alpine`   \n    - `namespace/repo:tag`\n- `digest` : `sha256:88885ce2e36df0fbb0f9313c53d9f5775f37385128b9818a5496806d59dd34e9`",
                "operationId": "download_layer_layer_download_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "image",
                        "required": true,
                        "schema": {
                            "title": "Image",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Layer digest, e.g., sha256:abc123...",
                        "in": "query",
                        "name": "digest",
                        "required": true,
                        "schema": {
                            "description": "Layer digest, e.g., sha256:abc123...",
                            "title": "Digest",
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Download Layer"
            }
        },
        "/peek": {
            "get": {
                "description": "## /peek\n\nScan headers of tar.gz layer image to infer filesystem,\noutput is printed by UI as a simulated tty running `ls -la`\n\n### CLI Equivalent\n\n`python main.py -t \"{image}\" --peek-layer={layer} --arch={arch} --force`\n\n- Args:\n    - `image`: Image reference (e.g., \"nginx/nginx:latest\")\n    - `layer`: Layer to peek - 'all' for all layers, or integer index for specific layer\n    - `arch`: Platform index for multi-arch images\n    - `hide_build`: If true, hide verbose build steps output\n    - `status_only`: If true, return JSON status without triggering a peek (same as /peek/status)",
                "operationId": "peek_peek_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "image",
                        "required": true,
                        "schema": {
                            "title": "Image",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "layer",
                        "required": false,
                        "schema": {
                            "default": "all",
                            "title": "Layer",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "arch",
                        "required": false,
                        "schema": {
                            "default": 0,
                            "title": "Arch",
                            "type": "integer"
                        }
                    },
                    {
                        "description": "Hide build steps output",
                        "in": "query",
                        "name": "hide_build",
                        "required": false,
                        "schema": {
                            "default": false,
                            "description": "Hide build steps output",
                            "title": "Hide Build",
                            "type": "boolean"
                        }
                    },
                    {
                        "description": "Return status JSON instead of peeking",
                        "in": "query",
                        "name": "status_only",
                        "required": false,
                        "schema": {
                            "default": false,
                            "description": "Return status JSON instead of peeking",
                            "title": "Status Only",
                            "type": "boolean"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Peek"
            }
        },
        "/peek/status": {
            "get": {
                "description": "## Peek Status\n\nGet layer peek status for an image without triggering a peek.\n\nReturns:\n- Whether config is cached\n- Layer count\n- List of layers with idx, digest, size, and peek status\n- Count of peeked vs unpeeked layers\n\nUse this endpoint to:\n- Check how many layers an image has before peeking\n- See which layers have already been peeked\n- Get the idx-to-digest mapping for precise operations\n\nExample: `/peek/status?image=nginx/nginx:alpine`",
                "operationId": "peek_status_peek_status_get",
                "parameters": [
                    {
                        "description": "Image reference: namespace/repo:tag",
                        "in": "query",
                        "name": "image",
                        "required": true,
                        "schema": {
                            "description": "Image reference: namespace/repo:tag",
                            "title": "Image",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Target architecture: amd64, arm64, etc.",
                        "in": "query",
                        "name": "arch",
                        "required": false,
                        "schema": {
                            "default": "amd64",
                            "description": "Target architecture: amd64, arm64, etc.",
                            "title": "Arch",
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Peek Status"
            }
        },
        "/repositories": {
            "get": {
                "description": "## /repositories\n\n\nPass-through proxy for Docker Hub's /v2/repositories API.\n\n- Returns the upstream JSON response verbatim.",
                "operationId": "repositories_repositories_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "namespace",
                        "required": true,
                        "schema": {
                            "title": "Namespace",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "page",
                        "required": false,
                        "schema": {
                            "title": "Page",
                            "type": "integer"
                        }
                    },
                    {
                        "in": "query",
                        "name": "page_size",
                        "required": false,
                        "schema": {
                            "title": "Page Size",
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Repositories"
            }
        },
        "/repositories/{namespace}/{repo}/tags": {
            "get": {
                "description": "## /tags\n\nPass-through proxy for Docker Hub's repository tags API.\n\n- Returns the upstream JSON response verbatim.",
                "operationId": "repository_tags_repositories__namespace___repo__tags_get",
                "parameters": [
                    {
                        "in": "path",
                        "name": "namespace",
                        "required": true,
                        "schema": {
                            "title": "Namespace",
                            "type": "string"
                        }
                    },
                    {
                        "in": "path",
                        "name": "repo",
                        "required": true,
                        "schema": {
                            "title": "Repo",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "page",
                        "required": false,
                        "schema": {
                            "title": "Page",
                            "type": "integer"
                        }
                    },
                    {
                        "in": "query",
                        "name": "page_size",
                        "required": false,
                        "schema": {
                            "title": "Page Size",
                            "type": "integer"
                        }
                    },
                    {
                        "in": "query",
                        "name": "ordering",
                        "required": false,
                        "schema": {
                            "default": "last_updated",
                            "title": "Ordering",
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Repository Tags"
            }
        },
        "/repositories/{namespace}/{repo}/tags/{tag}/config": {
            "get": {
                "description": "## Get Image Build Config\n\nFetch the full image configuration JSON for a tagged image.\n\n- Configs are cached in SQLite to avoid redundant upstream requests\n- Use `force_refresh=true` to bypass cache and fetch fresh data\n\n- Returns useful OSINT metadata:\n    - environment variables\n    - entrypoint\n    - 'cmd' history\n    - working directory\n    - labels\n    - build history\n    - and other image metadata",
                "operationId": "get_tag_config_repositories__namespace___repo__tags__tag__config_get",
                "parameters": [
                    {
                        "in": "path",
                        "name": "namespace",
                        "required": true,
                        "schema": {
                            "title": "Namespace",
                            "type": "string"
                        }
                    },
                    {
                        "in": "path",
                        "name": "repo",
                        "required": true,
                        "schema": {
                            "title": "Repo",
                            "type": "string"
                        }
                    },
                    {
                        "in": "path",
                        "name": "tag",
                        "required": true,
                        "schema": {
                            "title": "Tag",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Target architecture: amd64, arm64, etc.",
                        "in": "query",
                        "name": "arch",
                        "required": false,
                        "schema": {
                            "description": "Target architecture: amd64, arm64, etc.",
                            "title": "Arch",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Bypass cache and fetch fresh from registry",
                        "in": "query",
                        "name": "force_refresh",
                        "required": false,
                        "schema": {
                            "default": false,
                            "description": "Bypass cache and fetch fresh from registry",
                            "title": "Force Refresh",
                            "type": "boolean"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Get Tag Config"
            }
        },
        "/repositories/{namespace}/{repo}/tags/{tag}/images": {
            "get": {
                "description": "## Images \n\nPass-through proxy for Docker Hub's repository tag images API.\n\n- Returns the upstream JSON response verbatim.\n-",
                "operationId": "repository_tag_images_repositories__namespace___repo__tags__tag__images_get",
                "parameters": [
                    {
                        "in": "path",
                        "name": "namespace",
                        "required": true,
                        "schema": {
                            "title": "Namespace",
                            "type": "string"
                        }
                    },
                    {
                        "in": "path",
                        "name": "repo",
                        "required": true,
                        "schema": {
                            "title": "Repo",
                            "type": "string"
                        }
                    },
                    {
                        "in": "path",
                        "name": "tag",
                        "required": true,
                        "schema": {
                            "title": "Tag",
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "page",
                        "required": false,
                        "schema": {
                            "title": "Page",
                            "type": "integer"
                        }
                    },
                    {
                        "in": "query",
                        "name": "page_size",
                        "required": false,
                        "schema": {
                            "title": "Page Size",
                            "type": "integer"
                        }
                    },
                    {
                        "in": "query",
                        "name": "ordering",
                        "required": false,
                        "schema": {
                            "default": "last_updated",
                            "title": "Ordering",
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Repository Tag Images"
            }
        },
        "/search.data": {
            "get": {
                "description": "## /search.data\n\nSearch Docker Hub for images, users, and organizations.\n\n- Returns formatted text table with search results.\n\n- Example: `/search.data?q=nginx&page=1&sortby=pull_count&order=desc`",
                "operationId": "search_data_search_data_get",
                "parameters": [
                    {
                        "description": "Search query",
                        "in": "query",
                        "name": "q",
                        "required": true,
                        "schema": {
                            "description": "Search query",
                            "title": "Q",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Page number",
                        "in": "query",
                        "name": "page",
                        "required": false,
                        "schema": {
                            "default": 1,
                            "description": "Page number",
                            "minimum": 1,
                            "title": "Page",
                            "type": "integer"
                        }
                    },
                    {
                        "description": "Sort field: pull_count or updated_at",
                        "in": "query",
                        "name": "sortby",
                        "required": false,
                        "schema": {
                            "default": "updated_at",
                            "description": "Sort field: pull_count or updated_at",
                            "title": "Sortby",
                            "type": "string"
                        }
                    },
                    {
                        "description": "Sort order: asc or desc",
                        "in": "query",
                        "name": "order",
                        "required": false,
                        "schema": {
                            "default": "desc",
                            "description": "Sort order: asc or desc",
                            "title": "Order",
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        },
                        "description": "Successful Response"
                    },
                    "422": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        },
                        "description": "Validation Error"
                    }
                },
                "summary": "Search Data"
            }
        }
    }
}